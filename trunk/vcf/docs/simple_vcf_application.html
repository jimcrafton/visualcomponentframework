<html>

<head>
<meta http-equiv="Content-Language" content="en-us">
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="GENERATOR" content="Microsoft FrontPage 4.0">
<meta name="ProgId" content="FrontPage.Editor.Document">
<title>Simple VCF application</title>
<link rel="stylesheet" type="text/css" href="vcf_2.css">
</head>

<body topmargin="0" leftmargin="0" bgcolor="#FFFFFF" style="font-family: Trebuchet MS">

<table border="0" width="100%" cellspacing="0" cellpadding="0" height="199">
  <tr>
    <td width="663"><img border="0" src="logo.jpg" width="663" height="199"></td>
    <td.docTop width="100%" align="right" valign="bottom" align="right">
    <td background="top-background.jpg" valign="bottom" align="right">Hosted by:
      <a href="http://sourceforge.net"><img src="http://sourceforge.net/sflogo.php?group_id=6796&amp;type=1" border="0" alt="SourceForge Logo"></a></td>
  </tr>
</table>
<!--
Main body table
-->
<table border="0" width="100%" height="100%" cellspacing="0" cellpadding="0">
  <tr>
    <td class="docLeft" width="117" valign="top" align="left"><img src="left_sidebar.jpg" width="120" height="1024"></td>
    <td valign="top">
      <table bgcolor="#0D4D99" border="0" cellspacing="0" cellpadding="0" width="100%">
        <tr>
          <td><a class="docTopic" href="main.html">Documentation Home</a></td>
        </tr>
      </table>
      <h1><a name="TopicTitle">Simple VCF application</a></h1>
      <h2><a name="Introduction">Introduction</a></h2>
      <p>This will cover the basic steps required to build a simple application
      in VCF using Microsoft's Visual C++ IDE. This assumes you have <a href="http://sourceforge.net/docman/display_doc.php?docid=10096&amp;group_id=6796">installed</a>
      the VCF and <a href="http://sourceforge.net/docman/display_doc.php?docid=10097&amp;group_id=6796">built</a>
      it, if necessary.&nbsp;</p>
      <p>To start with, we're going to use the VCF application wizard that
      should have come with and been installed on your system (again, either as
      a result of the installation process, or because you built it). So create
      a new project by clicking the &quot;File | New...&quot;, select the
      &quot;Projects&quot; tab, and click on the &quot;<b>Visual Component
      Framework ApplicationKit AppWizard</b>&quot; item, give the project a
      name, (let's be original and call it &quot;HelloWorld&quot;) and click OK.</p>
      <p><img border="0" src="http://vcf.sourceforge.net/new_vcf_project.png" width="561" height="402"></p>
      <p>This will then take you through a series of steps - for this first
      time, just ignore them and click on the &quot;Finish&quot; button.&nbsp;</p>
      <p><img border="0" src="http://vcf.sourceforge.net/new_vcf_project_finish.png" width="477" height="386"></p>
      <p>This should now make a new project for you, and you should end up a new
      workspace called &quot;HelloWorld&quot;, a new project called
      &quot;HelloWorld&quot; and a single cpp file named
      &quot;HelloWorld.cpp&quot;. If you build and run now you will end with a
      little program like so:</p>
      <p><img border="0" src="http://vcf.sourceforge.net/hello_world1.png" width="308" height="253"></p>
      <p>Very quickly lets go through the major parts of the application.</p>
      <pre><b>int</b> main( <b>int</b> argc, <b>char</b> *argv[])
{	
	HelloWorldApplication app;

	Application::appMain( argc, argv );

	<b>return</b> 0;
}
</pre>
      <p>The first thing you may notice that's different is that you're Windows
      program has a &quot;main&quot; ! This is too maintain consistency between
      platforms. For those curious about how this is achieved see the linker
      options and look in the &quot;Output &quot; category. Inside of your
      main() there is a single instance of&nbsp; a class that derives from
      VCF::Application and is created on the stack. This serves as your main
      application instance, and for those coming from an MFC background is
      analogous to MFC's CWinApp class. The next step calls a static method,
      Application::appMain( argc, argv ), which initializes the application and
      starts the main application loop. This is all that's needed to create and
      run a VCF application.&nbsp;</p>
      <pre><b>class</b> HelloWorldApplication : <b>public</b> Application {
<b>public</b>:

	<b>virtual</b> <b>bool</b> initRunningApplication(){
		<b>bool</b> result = Application::initRunningApplication();
		
		Window* mainWindow = <b>new</b> HelloWorldWindow();
		setMainWindow(mainWindow);
		mainWindow-&gt;setBounds( &amp;Rect( 100.0, 100.0, 500.0, 500.0 ) );
		<b>return</b> result;
	}
};
</pre>
      <p>If you look at the HelloWorldApplication class you'll notice it has a
      single method: initRunningApplication(). This is overridden from the base
      class, and it is called by the framework during the initialization phase
      of the application start up. All your application specific startup code
      should go inside of this method (once again, for those familiar with MFC,
      this is similar to CWinApp's InitInstance() method). In this case you can
      see that the base class's initRunningApplication is called first. Then a
      new Window class is instantiated on the heap. Please note that as a rule
      all Component derived classes should <b><i>never</i></b> be created on the
      stack. There are exceptions to this but we'll go into that later. After
      the mainWindow has been created we set it as the application's main
      window, via Application::setMainWindow. This is done, among other reasons,
      so that when this window closes, it will automatically shutdown the
      application as well. The mainWindow's bounds are then set, and the method
      returns. This is all the code we need to display a window and position it
      programmatically.&nbsp;</p>
      <pre><b>class</b> HelloWorldWindow : <b>public</b> Window {
<b>public</b>:
	HelloWorldWindow() {
		setCaption( &quot;HelloWorld&quot; );
		setVisible( <b>true</b> );
	}

	<b>virtual</b> ~HelloWorldWindow(){};

};
</pre>
      <p>The last step in our code is to examine the constructor for the
      HelloWorldWindow. Note that in your
      HelloWorldApplication::initRunningApplication() method you created an
      instance of a HelloWorldWindow window, which had in it's title bar the
      text &quot;HelloWorld&quot;. In your constructor for the HelloWorldWindow
      class you can see exactly how that was done. Note the setCaption() method
      - calling this, and passing in some text, will change the title of your
      window. Next we call setVisible() and pass in true, indicating to the
      framework that we would like to display the window.</p>
      <p>And that's it. You have just built your first VCF application using the
      wizards and you now are the proud owner of an application that displays
      &quot;HelloWorld&quot; on it's title bar.</p>
      <!-- end content -->
      <p>&nbsp;</p>
      <p>&nbsp;</p>
    </td>
  </tr>
</table>

</body>
