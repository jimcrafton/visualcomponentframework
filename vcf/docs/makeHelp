#script for building help docs
#!/bin/sh
#CVS Log info
#$Log$
#Revision 1.2  2003/05/17 20:36:53  ddiego
#this is the checkin for the 0.6.1 release - represents the merge over from
#the devmain-0-6-0 branch plus a few minor bug fixes
#
#Revision 1.1.2.1  2003/03/03 05:00:41  ddiego
#added Makefile for creating html, htmlhelp, a tar.gz dist, and cleaning up
#

#this should get fed a version number

HTMLHELP_COMPILER="D:/Program Files/HTML Help Workshop/hhc.exe"
VERSION=$1
RAW_CHM_FILENAME=vcf_docs.chm
VERSIONED_CHM_FILENAME=VCFDocs.$VERSION.chm
HTML_TAR_FILENAME=VCFDocs.$VERSION.tar
if  test -z $VERSION  
then
	echo "usage: pass in a verison number, like n.n.n (example 0.1.2)"
else
	xsltproc --catalogs --docbook vcf.xsl vcf_docbook.sgml
	if test -f htmlhelp.hhp
	then
		"$HTMLHELP_COMPILER" htmlhelp.hhp
		
		if  test -f $RAW_CHM_FILENAME
		then
			mv $RAW_CHM_FILENAME $VERSIONED_CHM_FILENAME 
			echo Whoohoo created $VERSIONED_CHM_FILENAME
			
			find *.html > files.out
			find gfx/ -type f -name '*' > images.out
			cat files.out images.out > all.out
			echo Creating tar file...
			tar -cf $HTML_TAR_FILENAME -T all.out
			gzip $HTML_TAR_FILENAME
			echo HTML files tarred and compressed as $HTML_TAR_FILENAME.gz
			rm all.out
			rm files.out
			rm images.out
			
		else
			echo Failed to create $RAW_CHM_FILENAME
		fi
	else
		echo "Failed to generate a .hhp for, not bothering with HTML Help generation"		
	fi
fi

